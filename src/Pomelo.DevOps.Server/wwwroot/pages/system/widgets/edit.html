<!--
    Copyright (c) Yuko(Yisheng) Zheng. All rights reserved.
    Licensed under the MIT. See LICENSE in the project root for license information.
-->
<div class="widget-edit-header">
    <a class="widget-edit-header-button" v-on:click="save">
        <svg t="1669804635301" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10225" width="20" height="20"><path d="M725.4 105.7H151.8c-27.1 0-49.2 22-49.2 49.1v711.8c0 27.1 22.1 49.1 49.2 49.1H866c27.1 0 49.2-22 49.2-49.1V294.8L725.4 105.7z m-399.4 40h338.8v241.9c0 12.9-10.5 23.3-23.5 23.3H349.5c-12.9 0-23.5-10.5-23.5-23.3V145.7z m5.4 727.6V612.5c0-4.1 3.4-7.4 7.5-7.4h363.4c4.1 0 7.5 3.3 7.5 7.4v260.8H331.4z m543.8-6.8c0 4.9-4.2 9.1-9.2 9.1H749.9V612.5c0-26.1-21.3-47.4-47.5-47.4H339c-26.2 0-47.5 21.3-47.5 47.4v263.2H151.8c-5 0-9.2-4.2-9.2-9.1V154.8c0-4.9 4.2-9.1 9.2-9.1H286v241.9c0 34.9 28.5 63.3 63.5 63.3h291.8c35 0 63.5-28.4 63.5-63.3V145.7h4l166.4 165.8v555z" fill="#403E3E" p-id="10226"></path><path d="M638.4 664H400.8c-11 0-20 9-20 20s9 20 20 20h237.6c11 0 20-9 20-20s-8.9-20-20-20zM638.4 765.1H400.8c-11 0-20 9-20 20s9 20 20 20h237.6c11 0 20-9 20-20s-8.9-20-20-20z" fill="#403E3E" p-id="10227"></path></svg>
        <span>{{ $root.localization.sr('SYSTEM_WIDGET_EDIT_SAVE') }}</span>
    </a>
    <a class="widget-edit-header-button" v-on:click="refresh">
        <svg t="1669818557821" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4276" width="20" height="20"><path d="M192 631.3c-6.9 0-13.8-2.9-18.8-8.5l-67.7-76.7c-9.1-10.4-8.1-26.2 2.2-35.3 10.4-9.1 26.2-8.1 35.3 2.2l67.7 76.7c9.1 10.4 8.1 26.2-2.2 35.3-4.7 4.3-10.6 6.3-16.5 6.3z m7.3 5.3c-7 0-14-2.9-18.9-8.7-9-10.5-7.9-26.2 2.6-35.3l81.7-70.5c10.5-9 26.2-7.9 35.3 2.6s7.9 26.2-2.6 35.3l-81.7 70.5c-4.8 4.1-10.6 6.1-16.4 6.1z m333.1 273.2c-16.6 0-30-13.4-30-30s13.4-30 30-30c164.9 0 299.1-134.2 299.1-299.1S697.3 251.6 532.4 251.6c-164.9 0-299.1 134.2-299.1 299.1 0 16.6-13.4 30-30 30s-30-13.4-30-30c0-48.5 9.5-95.5 28.2-139.8 18.1-42.8 44-81.2 76.9-114.1 33-33 71.4-58.9 114.1-76.9 44.3-18.7 91.3-28.2 139.8-28.2s95.5 9.5 139.8 28.2c42.8 18.1 81.2 44 114.1 76.9 33 33 58.9 71.4 76.9 114.1 18.7 44.3 28.2 91.3 28.2 139.8 0 48.5-9.5 95.5-28.2 139.8-18.1 42.8-44 81.2-76.9 114.1-33 33-71.4 58.9-114.1 76.9-44.2 18.8-91.2 28.3-139.7 28.3z" p-id="4277"></path></svg>
        <span>{{ $root.localization.sr('SYSTEM_WIDGET_EDIT_DISCARD') }}</span>
    </a>
    <a class="widget-edit-header-button" target="_blank" v-bind:href="`/api/widget/${widgetId}/export?session=${encodeURIComponent($root.getToken())}`">
        <svg t="1671882963472" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4775" width="20" height="20"><path d="M849.05692664 613.13808896c9.30425926 0 17.26874497 3.29752417 23.82918686 9.88762989 6.6098799 6.59504907 9.89751734 14.52492761 9.89751663 23.79457969v134.81782685c0 28.12041791-9.74425854 51.91005424-29.21300075 71.37879643C833.73110077 872.89600096 810.03045298 882.78363013 782.44396702 882.78363013H242.33221152c-27.55187952 0-51.43050438-9.88762917-71.62104375-29.56401152C151.04961695 833.03896669 141.21142578 809.24933037 141.21142578 781.64801286V646.81535518c0-9.2696528 3.28763673-17.20447542 9.89751734-23.79458041 6.56044191-6.59010498 14.51504016-9.88762917 23.82918686-9.88762918 9.29437179 0 17.25391343 3.29752417 23.81435534 9.88762918 6.62471144 6.59504907 9.89751734 14.52492761 9.89751661 23.7945804v134.81782686c0 9.37841624 3.27280519 17.30335141 9.89751734 23.89839976 6.58516089 6.59010498 14.51504016 9.88762917 23.83413024 9.88762989h540.12658704c9.13616963 0 16.90784601-3.29752417 23.31008648-9.88762989 6.38740892-6.59010498 9.59100049-14.52492761 9.59100048-23.8934564V646.81535518c0-9.2696528 3.31235572-17.20447542 9.87774171-23.79458041 6.62471144-6.59010498 14.54470252-9.88762917 23.85390587-9.88762918h-0.08404445zM511.99752831 141.31524585c9.47729296 0 17.49121666 3.1937041 23.97750085 9.67998902l168.53958699 168.50498052c6.47639747 6.48628492 9.73931519 14.51998353 9.73931518 23.99727648 0 9.67998902-3.21347974 17.71368835-9.61571949 24.10109656-6.39729638 6.38246483-14.43099499 9.57616895-24.08132163 9.57616895-9.50695531 0-17.49121666-3.1937041-23.97750157-9.67998903L545.71434434 256.35287029v390.46248488c0 9.2696528-3.30246827 17.30335141-9.8777417 23.89345642-6.59999243 6.49122901-14.53481506 9.88762917-23.84401841 9.88762915-9.29931517 0-17.23413778-3.39640089-23.83413095-9.88762915-6.58516089-6.59010498-9.87774172-14.62380361-9.87774171-23.89345641V256.35287029l-110.85515685 111.13695398c-6.86201468 6.48628492-14.83144375 9.67998902-23.97750083 9.67998974-9.30425926 0-17.25391343-3.29258081-23.81929941-9.8876299-6.62471144-6.59010498-9.89751734-14.51998353-9.89751735-23.78963632 0-9.17077608 3.23325465-17.10065534 9.7343711-24.00221984L487.99036366 151.00017896C494.49642421 144.50894996 502.47574074 141.21142578 511.96786523 141.21142578L511.99752831 141.31030177z" p-id="4776"></path></svg>
        <span>{{ $root.localization.sr('SYSTEM_WIDGET_EDIT_EXPORT_TO_JSON') }}</span>
    </a>
    <a class="widget-edit-header-button" v-on:click="settings = true; active = null;">
        <svg t="1671883439772" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8061" width="20" height="20"><path d="M512.433 354.247c-87.289 0-158.303 71.015-158.303 158.303s71.015 158.303 158.303 158.303 158.303-71.015 158.303-158.303c0-87.289-71.014-158.303-158.303-158.303z m0 252.606c-51.999 0-94.303-42.304-94.303-94.303s42.304-94.303 94.303-94.303c51.999 0 94.303 42.304 94.303 94.303s-42.304 94.303-94.303 94.303z" p-id="8062"></path><path d="M927.429 426.42h-69.053c-8.516-34.55-22.03-67.223-40.382-97.626l48.787-48.787a31.997 31.997 0 0 0 0-45.254l-76.552-76.551c-12.496-12.497-32.758-12.497-45.254 0l-48.789 48.788c-30.403-18.351-63.075-31.866-97.624-40.383V97.554c0-17.673-14.327-32-32-32H458.303c-17.673 0-32 14.327-32 32v69.052c-34.548 8.517-67.221 22.032-97.624 40.383l-48.789-48.788c-12.496-12.497-32.757-12.497-45.254 0l-76.552 76.551a32.001 32.001 0 0 0 0 45.254l48.788 48.788c-18.352 30.404-31.867 63.076-40.383 97.626H97.438c-17.673 0-32 14.327-32 32v108.26c0 17.673 14.327 32 32 32h69.052c8.516 34.55 22.031 67.222 40.383 97.625l-48.788 48.789a32.001 32.001 0 0 0 0 45.255l76.552 76.551c12.497 12.496 32.758 12.497 45.255-0.001l48.788-48.787c30.402 18.351 63.075 31.865 97.625 40.382v69.052c0 17.673 14.327 32 32 32h108.259c17.673 0 32-14.327 32-32v-69.052c34.55-8.517 67.222-22.031 97.625-40.382l48.788 48.787c12.496 12.498 32.758 12.497 45.254 0.001l76.552-76.551c12.497-12.497 12.497-32.758 0.001-45.255l-48.788-48.789c18.352-30.402 31.866-63.074 40.383-97.625h69.052c17.673 0 32-14.327 32-32V458.42c-0.002-17.673-14.329-32-32.002-32z m-32 108.26H832.34c-15.626 0-28.967 11.285-31.557 26.695-7.38 43.894-24.164 84.468-49.887 120.594-9.063 12.728-7.608 30.14 3.439 41.188l44.563 44.564-31.297 31.296-44.563-44.563c-11.047-11.049-28.459-12.504-41.187-3.44-36.128 25.722-76.702 42.507-120.597 49.888-15.409 2.591-26.693 15.932-26.693 31.557v63.087h-44.259v-63.087c0-15.625-11.285-28.966-26.693-31.557-43.895-7.382-84.469-24.166-120.596-49.888-12.729-9.063-30.139-7.61-41.188 3.44l-44.563 44.563-31.297-31.296 44.563-44.564c11.048-11.048 12.502-28.46 3.44-41.188-25.724-36.128-42.508-76.701-49.887-120.594-2.59-15.41-15.931-26.695-31.557-26.695h-63.088v-44.26h63.088c15.626 0 28.967-11.285 31.557-26.695 7.379-43.893 24.163-84.467 49.887-120.596 9.062-12.728 7.607-30.14-3.44-41.188l-44.563-44.563 31.296-31.296 44.564 44.563c11.048 11.048 28.458 12.503 41.186 3.441 36.13-25.723 76.705-42.507 120.597-49.888 15.409-2.591 26.693-15.932 26.693-31.557v-63.087h44.259v63.087c0 15.625 11.284 28.966 26.693 31.557 43.892 7.38 84.467 24.165 120.598 49.888 12.728 9.061 30.139 7.607 41.186-3.441l44.563-44.563 31.297 31.296-44.563 44.563c-11.049 11.048-12.503 28.459-3.44 41.188 25.723 36.128 42.507 76.702 49.887 120.596 2.59 15.41 15.931 26.695 31.557 26.695h63.089v44.26z" p-id="8063"></path></svg>
        <span>{{ $root.localization.sr('SYSTEM_WIDGET_EDIT_SETTINGS') }}</span>
    </a>
</div>
<div class="widget-edit-left">
    <div class="widget-edit-files-header">
        {{ widget.name }}
        <a v-bind:title="$root.localization.sr('SYSTEM_WIDGET_EDIT_NEW_FOLDER')" v-on:click="newFolder">
            <svg t="1671870218343" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3686" width="20" height="20"><path d="M919.68 929.92H104.32A96.64 96.64 0 0 1 7.68 832V148.48A97.28 97.28 0 0 1 104.32 51.84H384a96.64 96.64 0 0 1 72.96 33.92l56.96 64a40.96 40.96 0 0 0 24.32 11.52l379.52-3.84A96.64 96.64 0 0 1 1016.32 256v576a96.64 96.64 0 0 1-96.64 97.92zM104.32 115.84a32.64 32.64 0 0 0-32.64 32.64V832a32 32 0 0 0 32.64 32h815.36a32 32 0 0 0 32.64-32V256a32 32 0 0 0-32.64-32l-378.88 3.84A103.68 103.68 0 0 1 467.2 192l-56.32-64A33.92 33.92 0 0 0 384 115.84z" fill="#323333" p-id="3687"></path><path d="M718.08 580.48H305.92a32 32 0 0 1-32-32 32 32 0 0 1 32-32h412.16a32 32 0 0 1 32 32 32 32 0 0 1-32 32z" fill="#323333" p-id="3688"></path><path d="M512 787.2a32 32 0 0 1-32-32V342.4a32 32 0 0 1 64 0v412.8a32 32 0 0 1-32 32z" fill="#323333" p-id="3689"></path></svg>
        </a>
        <a v-bind:title="$root.localization.sr('SYSTEM_WIDGET_EDIT_UPLOAD_FILE')" v-on:click="selectFile">
            <svg t="1671870589030" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5903" width="20" height="20"><path d="M833.47 337.03C804.22 187.15 672.62 73.83 511.77 73.83c-160.84 0-292.44 113.32-321.69 263.2C80.42 366.28 0 468.63 0 585.61c0 142.57 113.32 255.9 255.89 255.9h36.56v-73.12h-36.56c-102.35 0-182.78-80.42-182.78-182.78 0-102.35 80.42-182.78 182.78-182.78 0-142.57 113.32-255.89 255.89-255.89s255.9 113.32 255.9 255.89c102.35 0 182.78 80.42 182.78 182.78s-80.42 182.78-182.78 182.78h-36.56v73.12h36.56c142.57 0 255.89-113.33 255.89-255.9-0.01-116.98-80.44-219.33-190.1-248.58z m0 0" fill="#323333" p-id="5904"></path><path d="M544.68 486.91c-14.63-10.97-29.24-14.63-43.87-7.31-3.65 0-7.31 3.65-10.97 7.31L380.17 592.92c-14.62 14.63-14.62 36.56 0 51.18 14.63 14.63 40.21 14.63 54.84 0l43.86-40.21v310.73c0 21.93 18.28 36.55 36.56 36.55 21.93 0 36.55-18.27 36.55-36.55V603.88l43.87 40.21c14.62 14.63 40.21 14.63 54.83 0 14.63-14.62 14.63-36.55 0-51.18l-106-106z m0 0" fill="#323333" p-id="5905"></path></svg>
        </a>
        <a v-bind:title="$root.localization.sr('SYSTEM_WIDGET_EDIT_NEW_FILE')" v-on:click="newFile">
            <svg t="1671870192276" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3541" width="20" height="20"><path d="M455.111111 967.111111H170.666667V56.888889h523.377777L853.333333 227.555556v341.333333h-56.888889V250.311111L671.288889 113.777778H227.555556v796.444444h227.555555z" fill="#333333" p-id="3542"></path><path d="M853.333333 341.333333h-284.444444V56.888889h56.888889v227.555555h227.555555zM455.111111 739.555556h398.222222v56.888888H455.111111z" fill="#333333" p-id="3543"></path><path d="M625.777778 568.888889h56.888889v398.222222h-56.888889z" fill="#333333" p-id="3544"></path></svg>
        </a>
    </div>
    <div class="widget-editor-tree-item-folder-padding">
        <widget-editor-tree-item v-for="item in widget.items"
                                 level="1"
                                 v-model="item" />
    </div>
</div>

<div class="widget-edit-right">
    <template v-if="active">
        <codemirror v-if="mimeType.indexOf('text/') == 0 || mimeType.indexOf('application/') == 0" v-model="text" v-bind:mode="mode"></codemirror>
        <img v-bind:src="`data:${mimeType};base64,${active.content}`" />
    </template>
    <template v-if="settings">
        <div class="dialog">
            <div class="dialog-header">
                <svg t="1671796753368" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6084" width="20" height="20"><path d="M793.6 563.2H179.2c-15.36 0-25.6 10.24-25.6 25.6v204.8H128c-15.36 0-25.6-10.24-25.6-25.6V230.4c0-15.36 10.24-25.6 25.6-25.6h640c15.36 0 25.6 10.24 25.6 25.6v332.8z" fill="#A9CFFF" p-id="6085"></path><path d="M230.4 614.4h691.2c15.36 0 25.6 10.24 25.6 25.6v179.2c0 15.36-10.24 25.6-25.6 25.6H230.4c-15.36 0-25.6-10.24-25.6-25.6v-179.2c0-15.36 10.24-25.6 25.6-25.6z m128 76.8v76.8h76.8v-76.8h-76.8z m179.2 0v76.8h76.8v-76.8h-76.8z m179.2 0v76.8h76.8v-76.8h-76.8z" fill="#2589FF" p-id="6086"></path></svg>
                <span>{{ $root.localization.sr('SYSTEM_WIDGET_EDIT_SETTINGS') }}</span>
            </div>

            <div class="field">
                <b>{{ $root.localization.sr('SYSTEM_WIDGET_WIDGET_ID') }}</b>
                <input type="text" disabled class="dialog-textbox" v-model="widget.id" />
            </div>

            <div class="field">
                <b>{{ $root.localization.sr('SYSTEM_WIDGET_WIDGET_NAME') }}</b>
                <input type="text" class="dialog-textbox" v-model="widget.name" />
            </div>

            <div class="field">
                <b>{{ $root.localization.sr('SYSTEM_WIDGET_WIDGET_DESCRIPTION') }}</b>
                <input type="text" class="dialog-textbox" v-model="widget.description" />
            </div>

            <div class="field">
                <b>{{ $root.localization.sr('SYSTEM_WIDGET_ICON_URL') }}</b>
                <input type="text" class="dialog-textbox" v-model="widget.iconUrl" />
            </div>

            <div class="field">
                <b>{{ $root.localization.sr('SYSTEM_WIDGET_WIDGET_ENTRY') }}</b>
                <input type="text" class="dialog-textbox" v-model="widget.widgetEntryView" />
            </div>

            <div class="field">
                <b>{{ $root.localization.sr('SYSTEM_WIDGET_CONFIG_ENTRY') }}</b>
                <input type="text" class="dialog-textbox" v-model="widget.configEntryView" />
            </div>
        </div>
    </template>
</div>
<input type="file" v-bind:id="`file-${widget.id}`" v-on:change="onFileSelected" v-if="widget" style="display: none" />